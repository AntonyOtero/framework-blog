---
import { getCollection } from 'astro:content';
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../consts';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body class="bg-night text-seasalt">
		<Header />
		<!-- Hero Section -->
		<section class="flex flex-col justify-center container max-w-4xl mx-auto px-6 py-20">
			<div class="">
				<div class="mb-16">
					<h1 class="text-6xl sm:text-8xl font-medium tracking-tight mb-8 font-serif">
						PRACTICAL
						<span class="block">METAPHYSICS</span>
					</h1>
					<p class="text-xl text-seasalt/75 max-w-2xl leading-relaxed">
						Thoughts on living consciously, carrying responsibility, and forging meaning where none is given. A framework in progress.
					</p>
				</div>
			</div>

		<!-- Category Navigation -->
		<div class="flex flex-wrap gap-4 mb-12">
		{posts.map((post) => (
			<button class="px-6 cursor-pointer rounded-xl border">
				{post.data.category}
			</button>
		))}
		</div>

		{/* Featured Post */}
        {posts.filter(post => post.data.featured).map((featuredPost) => (
            <div data-key={featuredPost.id} class="p-8 mb-16 cursor-pointer flex flex-col gap-6 rounded-xl border">
              <div class="flex items-start justify-between mb-4">
                <div class="px-3 py-1">
                  {featuredPost.data.category}
                </div>
                <div class="flex items-center gap-4 text-sm text-muted-foreground">
                  <div class="flex items-center gap-1">
                    <span class="w-4 h-4" />
                    {new Date(featuredPost.data.pubDate).toLocaleDateString('en-US', { 
                      month: 'short', 
                      day: 'numeric',
                      year: 'numeric'
                    })}
                  </div>
                  <div class="flex items-center gap-1">
                    <span class="w-4 h-4" />
                    {featuredPost.data.duration}
                  </div>
                </div>
              </div>
              <h2 class="text-3xl font-medium mb-4 leading-tight">
                {featuredPost.data.title}
              </h2>
              <p class="text-lg text-seasalt/90 mb-6 leading-relaxed">
                {featuredPost.data.description}
              </p>
              <button>
                Read Full Article ›
              </button>
            </div>
        ))}

		  {/* Posts Grid */}
          <div class="grid md:grid-cols-2 gap-8 mx-auto text-seasalt">
            {
				posts.filter(post => !post.data.featured).map((post) => (
					<div data-key={post.id} class="p-6 cursor-pointer flex flex-col gap-6 rounded-xl border">
						<div class="flex items-center justify-between mb-3">
							<div class="text-xs px-2 py-1">
								{post.data.category}
							</div>
							<div class="flex items-center gap-3 text-xs text-muted-foreground">
								<span>
									{new Date(post.data.pubDate).toLocaleDateString('en-US', { 
										month: 'short', 
										day: 'numeric' 
									})}
								</span>
								<span>{post.data.duration}</span>
							</div>
						</div>
						<h3 class="text-xl font-medium mb-3 leading-tight">
							{post.data.title}
						</h3>
						<p class="text-seasalt/90 mb-4 leading-relaxed">
							{post.data.description}
						</p>
						<button class="p-0 h-auto group text-primary">
							Read More ›
						</button>
					</div>
				))
			}
          </div>

		  {/* Load More */}
          <!-- <div class="text-center mt-16">
            <Button variant="outline" size="lg" class="px-8">
              Load More Posts
            </Button>
          </div>
        </div> -->
      </section>

		<Footer />
	</body>
</html>
